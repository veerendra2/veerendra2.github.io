<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Elasticsearch Installation | Veerendra's Blog</title>
<meta name=keywords content="elasticsearch"><meta name=description content='
&#x1f449; This writeup is part of &ldquo;Elasticsearch Deploy Docs&rdquo; series

Install

&#x1f4c4; Office Docs

Hardware Requirement

&#x1f4c4; Offical Docs


  
      
          Resource
          Minimum
          Recommended
      
  
  
      
          Memory
          16 GB
          64 GB
      
      
          CPU
          8 Cores
          16
      
      
          Disk
          Depends
          Depends
      
  

JDK Installation

Pick JVM compatibility version with elasticsearch from here
Install OpenJDK from here
Download and install JDK 11 (Another guide here)

$ apt-get install openjdk-11-jdk -y
$ java -version
openjdk version "11.0.6" 2020-01-14
OpenJDK Runtime Environment (build 11.0.6+10-post-Ubuntu-1ubuntu118.04.1)
OpenJDK 64-Bit Server VM (build 11.0.6+10-post-Ubuntu-1ubuntu118.04.1, mixed mode, sharing)
Elasticsearch Installation

Download latest elasticsearch from here (As of today the latest version is 7.6.2)
Recommended to download/install package via .dep or PPA which postscripts creates user, groups and adds under systemd

Install via apt-get from here'><meta name=author content="Veerendra K"><link rel=canonical href=https://veerendra2.github.io/elasticsearch-deploy/install/><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=https://veerendra2.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://veerendra2.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://veerendra2.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://veerendra2.github.io/apple-touch-icon.png><link rel=mask-icon href=https://veerendra2.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://veerendra2.github.io/elasticsearch-deploy/install/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Elasticsearch Installation"><meta property="og:description" content='
&#x1f449; This writeup is part of &ldquo;Elasticsearch Deploy Docs&rdquo; series

Install

&#x1f4c4; Office Docs

Hardware Requirement

&#x1f4c4; Offical Docs


  
      
          Resource
          Minimum
          Recommended
      
  
  
      
          Memory
          16 GB
          64 GB
      
      
          CPU
          8 Cores
          16
      
      
          Disk
          Depends
          Depends
      
  

JDK Installation

Pick JVM compatibility version with elasticsearch from here
Install OpenJDK from here
Download and install JDK 11 (Another guide here)

$ apt-get install openjdk-11-jdk -y
$ java -version
openjdk version "11.0.6" 2020-01-14
OpenJDK Runtime Environment (build 11.0.6+10-post-Ubuntu-1ubuntu118.04.1)
OpenJDK 64-Bit Server VM (build 11.0.6+10-post-Ubuntu-1ubuntu118.04.1, mixed mode, sharing)
Elasticsearch Installation

Download latest elasticsearch from here (As of today the latest version is 7.6.2)
Recommended to download/install package via .dep or PPA which postscripts creates user, groups and adds under systemd

Install via apt-get from here'><meta property="og:type" content="article"><meta property="og:url" content="https://veerendra2.github.io/elasticsearch-deploy/install/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-09-10T17:41:52+02:00"><meta property="article:modified_time" content="2022-09-10T17:41:52+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Elasticsearch Installation"><meta name=twitter:description content='
&#x1f449; This writeup is part of &ldquo;Elasticsearch Deploy Docs&rdquo; series

Install

&#x1f4c4; Office Docs

Hardware Requirement

&#x1f4c4; Offical Docs


  
      
          Resource
          Minimum
          Recommended
      
  
  
      
          Memory
          16 GB
          64 GB
      
      
          CPU
          8 Cores
          16
      
      
          Disk
          Depends
          Depends
      
  

JDK Installation

Pick JVM compatibility version with elasticsearch from here
Install OpenJDK from here
Download and install JDK 11 (Another guide here)

$ apt-get install openjdk-11-jdk -y
$ java -version
openjdk version "11.0.6" 2020-01-14
OpenJDK Runtime Environment (build 11.0.6+10-post-Ubuntu-1ubuntu118.04.1)
OpenJDK 64-Bit Server VM (build 11.0.6+10-post-Ubuntu-1ubuntu118.04.1, mixed mode, sharing)
Elasticsearch Installation

Download latest elasticsearch from here (As of today the latest version is 7.6.2)
Recommended to download/install package via .dep or PPA which postscripts creates user, groups and adds under systemd

Install via apt-get from here'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://veerendra2.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Elasticsearch Deployment Docs","item":"https://veerendra2.github.io/posts/elasticsearch-deploy/"},{"@type":"ListItem","position":3,"name":"Elasticsearch Installation","item":"https://veerendra2.github.io/elasticsearch-deploy/install/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Elasticsearch Installation","name":"Elasticsearch Installation","description":" \u0026#x1f449; This writeup is part of \u0026ldquo;Elasticsearch Deploy Docs\u0026rdquo; series\nInstall \u0026#x1f4c4; Office Docs\nHardware Requirement \u0026#x1f4c4; Offical Docs\nResource Minimum Recommended Memory 16 GB 64 GB CPU 8 Cores 16 Disk Depends Depends JDK Installation Pick JVM compatibility version with elasticsearch from here Install OpenJDK from here Download and install JDK 11 (Another guide here) $ apt-get install openjdk-11-jdk -y $ java -version openjdk version \u0026#34;11.0.6\u0026#34; 2020-01-14 OpenJDK Runtime Environment (build 11.0.6+10-post-Ubuntu-1ubuntu118.04.1) OpenJDK 64-Bit Server VM (build 11.0.6+10-post-Ubuntu-1ubuntu118.04.1, mixed mode, sharing) Elasticsearch Installation Download latest elasticsearch from here (As of today the latest version is 7.6.2) Recommended to download/install package via .dep or PPA which postscripts creates user, groups and adds under systemd Install via apt-get from here\n","keywords":["elasticsearch"],"articleBody":" üëâ This writeup is part of ‚ÄúElasticsearch Deploy Docs‚Äù series\nInstall üìÑ Office Docs\nHardware Requirement üìÑ Offical Docs\nResource Minimum Recommended Memory 16 GB 64 GB CPU 8 Cores 16 Disk Depends Depends JDK Installation Pick JVM compatibility version with elasticsearch from here Install OpenJDK from here Download and install JDK 11 (Another guide here) $ apt-get install openjdk-11-jdk -y $ java -version openjdk version \"11.0.6\" 2020-01-14 OpenJDK Runtime Environment (build 11.0.6+10-post-Ubuntu-1ubuntu118.04.1) OpenJDK 64-Bit Server VM (build 11.0.6+10-post-Ubuntu-1ubuntu118.04.1, mixed mode, sharing) Elasticsearch Installation Download latest elasticsearch from here (As of today the latest version is 7.6.2) Recommended to download/install package via .dep or PPA which postscripts creates user, groups and adds under systemd Install via apt-get from here\n$ wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add - $ sudo apt-get install apt-transport-https $ echo \"deb https://artifacts.elastic.co/packages/7.x/apt stable main\" | sudo tee -a /etc/apt/sources.list.d/elastic-7.x.list $ sudo apt-get update \u0026\u0026 sudo apt-get install elasticsearch *DON‚ÄôT START elasticsearch DAEMON YET!!! We need to configure\nSystem Configuration üìÑ Official Docs\nCreate data directory(This data directory you have to specify in elasticsearch config) $ mkdir /var/data/elasticsearch $ chown -R elasticsearch:elasticsearch /var/data/elasticsearch Disable swapping $ sudo swapoff -a ## *** Perminent Config *** ## Comment out any lines that contain the word 'swap' in '/etc/fstab' Increase mmap count $ sudo sysctl -w vm.max_map_count=262144 ## *** Perminent Config *** ## update the vm.max_map_count setting in /etc/sysctl.conf Increase file descriptors for elasticseach user $ sudo su # ulimit -n 65535 ## *** Perminent Config *** ## echo 'elasticsearch - nofile 65535'| sudo tee /etc/security/limits.conf ## Ubuntu ignores the limits.conf file for processes started by init.d. To enable the limits.conf file, edit /etc/pam.d/su and uncomment the following line ## # session required pam_limits.so Systems which uses systemd limits need to be specified via systemd\n$ sudo systemctl edit elasticsearch ## Above command opens editor to override the config. Add below setting in it [Service] LimitMEMLOCK=infinity Increase number of threads count for elasticsearch user $ sudo su # ulimit -u 4096 ## *** Perminent Config *** ## echo 'elasticsearch - nproc 4096'| sudo tee /etc/security/limits.conf ## Ubuntu ignores the limits.conf file for processes started by init.d. To enable the limits.conf file, edit /etc/pam.d/su and uncomment the following line ## # session required pam_limits.so JVM Configuration Elasticsearch needs more heap memory. Change the JVM heap memory accordingly, please be noted that more heap means more garbage collection i.e more CPU utilization\nChange max and min heap in /etc/elasticsearch/jvm.options like below (Currently we are setting 15GB for heap)\n... -Xms15g -Xmx15g ... Go through other JVM config or logging config if required NOTE: Make sure min and max heap memories are same value to avoid bootstrap check failures\nElasticsearch Configuration üìÑ Official Docs\nIf you install elasticsearch via apt-get or .dep file, the config files are located in /etc/elasticsearch/ directory Refer elasticsearch.yml configuration in config_sample directory specify nodes and copy configurations to nodes accordingly Once everything is ready, start elasticsearch daemon in all nodes\n$ sudo systemctl enable elasticsearch $ sudo systemctl start elasticsearch If everything is ok, you should get responses like below\n$ curl -XGET 10.29.103.18:9200 { \"name\" : \"carbon-1\", \"cluster_name\" : \"carbon\", \"cluster_uuid\" : \"zpoOdANFSXujgNMplMz1fQ\", \"version\" : { \"number\" : \"7.6.2\", \"build_flavor\" : \"default\", \"build_type\" : \"deb\", \"build_hash\" : \"ef48eb35cf30adf4db14086e8aabd07ef6fb113f\", \"build_date\" : \"2020-03-26T06:34:37.794943Z\", \"build_snapshot\" : false, \"lucene_version\" : \"8.4.0\", \"minimum_wire_compatibility_version\" : \"6.8.0\", \"minimum_index_compatibility_version\" : \"6.0.0-beta1\" }, \"tagline\" : \"You Know, for Search\" } $ curl -XGET 10.29.103.18:9200/_cat/nodes 10.29.103.18 7 74 5 0.07 0.91 1.95 dilm * carbon-1 10.29.103.10 2 87 25 0.08 1.08 1.68 dil - carbon-3 10.29.103.16 5 76 25 0.18 1.13 1.75 dil - carbon-2 Configure Security Starting from versions 6.8.0 and 7.1.0, security comes in basic. Read update blog here Watch Getting Started with Free Elasticsearch Security Features Configure transport layer SSL for node communication There is tool elasticsearch-certutil which comes with elasticsearch installation. Depends on requirement generate keys csr to get certificate signing request and sign it with CA cert to get self signed cerificates ca to get certificate authority http for certificates fot HTTP $ cd /usr/share/elasticsearch/bin $ ./elasticsearch-certutil --help Simplifies certificate creation for use with the Elastic Stack Commands -------- csr - generate certificate signing requests cert - generate X.509 certificates and keys ca - generate a new local certificate authority http - generate a new certificate (or certificate request) for the Elasticsearch HTTP interface Non-option arguments: command Option Description ------ ----------- -E Configure a setting -h, --help Show help -s, --silent Show minimal output -v, --verbose Show verbose output Generating .p12 and copy the file to every node\n./elasticsearch-certutil cert ... Please enter the desired output file [elastic-certificates.p12]:/etc/elasticsearch/elastic-certificates.p12 ... Enable SSL and specify .p12 file location in config like below in every node in elasticsearch.yml xpack.security.enabled: true xpack.security.transport.ssl.enabled: true xpack.security.transport.ssl.verification_mode: certificate xpack.security.transport.ssl.keystore.path: /etc/elasticsearch/elastic-certificates.p12 xpack.security.transport.ssl.truststore.path: /etc/elasticsearch/elastic-certificates.p12 Restart elasticsearch daemon in all nodes\n$ sudo systemctl restart elasticsearch Generate Passwords Login into master node and run below commands $ cd /usr/share/elasticsearch $ sudo bin/elasticsearch-setup-passwords auto Initiating the setup of passwords for reserved users elastic,apm_system,kibana,kibana_system,logstash_system,beats_system,remote_monitoring_user. The passwords will be randomly generated and printed to the console. Please confirm that you would like to continue [y/N]y Changed password for user apm_system PASSWORD apm_system = xxxxxxxxxxxxxx Changed password for user kibana PASSWORD kibana = xxxxxxxxxxxxxx Changed password for user logstash_system PASSWORD logstash_system = xxxxxxxxxxxxxx Changed password for user beats_system PASSWORD beats_system = xxxxxxxxxxxxxx Changed password for user remote_monitoring_user PASSWORD remote_monitoring_user = xxxxxxxxxxxxxx Changed password for user elastic PASSWORD elastic = xxxxxxxxxxxxxx Copy those credentials and store it safe.\nThe elastic user is cluster admin user The kibana user is for kibana to authenticate with elasticsearch Configure HTTPS for REST API Generate certificates(Below is the process to generate certificates) $ cd /usr/share/elasticsearch $ sudo bin/elasticsearch-certutil http ## Elasticsearch HTTP Certificate Utility The 'http' command guides you through the process of generating certificates for use on the HTTP (Rest) interface for Elasticsearch. This tool will ask you a number of questions in order to generate the right set of files for your needs. ## Do you wish to generate a Certificate Signing Request (CSR)? A CSR is used when you want your certificate to be created by an existing Certificate Authority (CA) that you do not control (that is, you don't have access to the keys for that CA). If you are in a corporate environment with a central security team, then you may have an existing Corporate CA that can generate your certificate for you. Infrastructure within your organisation may already be configured to trust this CA, so it may be easier for clients to connect to Elasticsearch if you use a CSR and send that request to the team that controls your CA. If you choose not to generate a CSR, this tool will generate a new certificate for you. That certificate will be signed by a CA under your control. This is a quick and easy way to secure your cluster with TLS, but you will need to configure all your clients to trust that custom CA. Generate a CSR? [y/N]n ## Do you have an existing Certificate Authority (CA) key-pair that you wish to use to sign your certificate? If you have an existing CA certificate and key, then you can use that CA to sign your new http certificate. This allows you to use the same CA across multiple Elasticsearch clusters which can make it easier to configure clients, and may be easier for you to manage. If you do not have an existing CA, one will be generated for you. Use an existing CA? [y/N]n A new Certificate Authority will be generated for you ## CA Generation Options The generated certificate authority will have the following configuration values. These values have been selected based on secure defaults. You should not need to change these values unless you have specific requirements. Subject DN: CN=Elasticsearch HTTP CA Validity: 5y Key Size: 2048 Do you wish to change any of these options? [y/N]n ## CA password We recommend that you protect your CA private key with a strong password. If your key does not have a password (or the password can be easily guessed) then anyone who gets a copy of the key file will be able to generate new certificates and impersonate your Elasticsearch cluster. IT IS IMPORTANT THAT YOU REMEMBER THIS PASSWORD AND KEEP IT SECURE CA password: [\u003cENTER\u003e for none] ## How long should your certificates be valid? Every certificate has an expiry date. When the expiry date is reached clients will stop trusting your certificate and TLS connections will fail. Best practice suggests that you should either: (a) set this to a short duration (90 - 120 days) and have automatic processes to generate a new certificate before the old one expires, or (b) set it to a longer duration (3 - 5 years) and then perform a manual update a few months before it expires. You may enter the validity period in years (e.g. 3Y), months (e.g. 18M), or days (e.g. 90D) For how long should your certificate be valid? [5y] 5Y ## Do you wish to generate one certificate per node? If you have multiple nodes in your cluster, then you may choose to generate a separate certificate for each of these nodes. Each certificate will have its own private key, and will be issued for a specific hostname or IP address. Alternatively, you may wish to generate a single certificate that is valid You entered the following hostnames. - elk-staging.mydomain.com Is this correct [Y/n]y ## Which IP addresses will be used to connect to your nodes? If your clients will ever connect to your nodes by numeric IP address, then you can list these as valid IP \"Subject Alternative Name\" (SAN) fields in your certificate. If you do not have fixed IP addresses, or not wish to support direct IP access to your cluster then you can just press \u003cENTER\u003e to skip this step. across all the hostnames or addresses in your cluster. If all of your nodes will be accessed through a single domain (e.g. node01.es.example.com, node02.es.example.com, etc) then you may find it simpler to generate one certificate with a wildcard hostname (*.es.example.com) and use that across all of your nodes. However, if you do not have a common domain name, and you expect to add additional nodes to your cluster in the future, then you should generate a certificate per node so that you can more easily generate new certificates when you provision new nodes. Generate a certificate per node? [y/N]n ## Which hostnames will be used to connect to your nodes? These hostnames will be added as \"DNS\" names in the \"Subject Alternative Name\" (SAN) field in your certificate. You should list every hostname and variant that people will use to connect to your cluster over http. Do not list IP addresses here, you will be asked to enter them later. If you wish to use a wildcard certificate (for example *.es.example.com) you can enter that here. Enter all the hostnames that you need, one per line. When you are done, press \u003cENTER\u003e once more to move on to the next step. elk-staging.mydomain.com Enter all the IP addresses that you need, one per line. When you are done, press \u003cENTER\u003e once more to move on to the next step. 85.xx.xx.xx 85.xx.xx.xx 85.xx.xx.xx You entered the following IP addresses. - 85.xx.xx.xx - 85.xx.xx.xx - 85.xx.xx.xx Is this correct [Y/n]y ## Other certificate options The generated certificate will have the following additional configuration values. These values have been selected based on a combination of the information you have provided above and secure defaults. You should not need to change these values unless you have specific requirements. Key Name: elk.mydomain.com Subject DN: CN=elk, DC=mydomain, DC=org Key Size: 2048 Do you wish to change any of these options? [y/N]n ## What password do you want for your private key(s)? Your private key(s) will be stored in a PKCS#12 keystore file named \"http.p12\". This type of keystore is always password protected, but it is possible to use a blank password. If you wish to use a blank password, simply press \u003center\u003e at the prompt below. Provide a password for the \"http.p12\" file: [\u003cENTER\u003e for none] ## Where should we save the generated files? A number of files will be generated including your private key(s), public certificate(s), and sample configuration options for Elastic Stack products. These files will be included in a single zip archive. What filename should be used for the output zip file? [/usr/share/elasticsearch/elasticsearch-ssl-http.zip] ./elasticsearch-certutil http 6.38s user 0.47s system 6% cpu 1:38.49 total The zip file /usr/share/elasticsearch/elasticsearch-ssl-http.zip contains below files\n$ unzip elasticsearch-ssl-http.zip $ tree . . ‚îú‚îÄ‚îÄ ca ‚îú‚îÄ‚îÄ README.txt ‚îî‚îÄ‚îÄ ca.p12 ‚îú‚îÄ‚îÄ elasticsearch ‚îú‚îÄ‚îÄ README.txt ‚îú‚îÄ‚îÄ http.p12 ‚îî‚îÄ‚îÄ sample-elasticsearch.yml ‚îî‚îÄ‚îÄ kibana ‚îú‚îÄ‚îÄ README.txt ‚îú‚îÄ‚îÄ elasticsearch-ca.pem ‚îî‚îÄ‚îÄ sample-kibana.yml Create new directory /etc/elasticsearch/http_ssl and copy http.p12 to all server\nAdd below config to /etc/elasticsearchelasticsearch.yml to enable http ssl like below\nxpack.security.http.ssl.enabled: true xpack.security.http.ssl.keystore.path: \"/etc/elasticsearch/http_ssl/http.p12\" HTTPS configurations for HTTP clients For Kibana ‚ùó Refer Kibana Installation to know more\nCreate /etc/kibana/ca and copy elasticsearch-ca.pem to kibana server\nAdd below config to kibana.yml to enable HTTPS communication between elasticsearch and kibana\nelasticsearch.ssl.certificateAuthorities: [ \"/etc/kibana/ca/elasticsearch-ca.pem\" ] For Beats Refer elasticsearch-deploy-notes/beats for demo config\nUse same .pem file to enable HTTPS communication between beats and elasticsearch(sample snippet below) output.elasticsearch: hosts: ['https://elk-staging.mydomain.com:9201'] username: admin password: 123123123 ssl: certificate_authorities: [\"/etc/elasticsearch-ca.pem\"] setup.dashboards: enabled: true setup.kibana: host: \"https://elk-staging.mydomain.com:5691\" ssl: certificate_authorities: [\"/etc/letsencryptauthorityx3.pem\"] Alerting The official Elasticsearch ‚ÄúBasic‚Äù version doesn‚Äôt include alerting. Below are the 2 opensource plugin available for elasticsearch\n1. Opendistro Elasticsearch Alerting ‚ö†Ô∏è Opendistro Alerting IS NOT compatible with X-Pack Security, for more information refer this issue. If the x-pack is already enabled, DO NOT install this plugin, won‚Äôt work!. In order to install this plugin, disable x-pack security and install opendistro security\nPick Opendistro alerting standalone plugin version compatibility here\nLogin into master node and install necessary plugins and alerting plugin like below ## Go elasticseatch bin directory $ cd /usr/share/elasticsearch/ ## Install Job Scheduler plugin $ sudo bin/elasticsearch-plugin install https://d3g5vo6xdbdb9a.cloudfront.net/downloads/elasticsearch-plugins/opendistro-job-scheduler/opendistro-job-scheduler-1.8.0.0.zip ## Install Alerting plugin $ sudo bin/elasticsearch-plugin install https://d3g5vo6xdbdb9a.cloudfront.net/downloads/elasticsearch-plugins/opendistro-alerting/opendistro_alerting-1.8.0.0.zip ## Restart Elasticsearch $ sudo systemctl restart elasticsearch 2. Elastalert Refer elastalert docs for installation instructions.\nStack Monitoring Offical Docs Kibana Docs Elasticsearch can monitor itself, enable stack monitoring using REST API like below\nPUT _cluster/settings { \"persistent\": { \"xpack.monitoring.collection.enabled\": true } } We can also monitor with metricbeat, this method is useful especially want to monitor multiple clusters. Please refer metricbeat elasticsearch-xpack module config\nElatic Beats Beats is a free and open platform for single-purpose data shippers. They send data from hundreds or thousands of machines and systems to Logstash or Elasticsearch.\nRefer elasticsearch-deploy-notes/beats for example config\n","wordCount":"2436","inLanguage":"en","datePublished":"2022-09-10T17:41:52+02:00","dateModified":"2022-09-10T17:41:52+02:00","author":{"@type":"Person","name":"Veerendra K"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://veerendra2.github.io/elasticsearch-deploy/install/"},"publisher":{"@type":"Organization","name":"Veerendra's Blog","logo":{"@type":"ImageObject","url":"https://veerendra2.github.io/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://veerendra2.github.io/ accesskey=h title="Veerendra's Blog (Alt + H)">Veerendra's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://veerendra2.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://veerendra2.github.io/posts/nuggets/ title=Nuggets><span>Nuggets</span></a></li><li><a href=https://veerendra2.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://veerendra2.github.io/>Home</a>&nbsp;¬ª&nbsp;<a href=https://veerendra2.github.io/posts/>Posts</a>&nbsp;¬ª&nbsp;<a href=https://veerendra2.github.io/posts/elasticsearch-deploy/>Elasticsearch Deployment Docs</a></div><h1 class="post-title entry-hint-parent">Elasticsearch Installation</h1><div class=post-meta><span title='2022-09-10 17:41:52 +0200 +0200'>September 10, 2022</span>&nbsp;¬∑&nbsp;12 min&nbsp;¬∑&nbsp;Veerendra K&nbsp;|&nbsp;<a href="https://github.com/veerendra2/veerendra2.github.io/issues/new?assignees=veerendra2&amp;labels=bug&amp;template=suggest-changes.md&amp;title=%5BCHANGE%5D" rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#install aria-label=Install>Install</a><ul><li><a href=#hardware-requirement aria-label="Hardware Requirement">Hardware Requirement</a></li><li><a href=#jdk-installation aria-label="JDK Installation">JDK Installation</a></li><li><a href=#elasticsearch-installation aria-label="Elasticsearch Installation">Elasticsearch Installation</a></li></ul></li><li><a href=#system-configuration aria-label="System Configuration">System Configuration</a><ul><li><a href=#jvm-configuration aria-label="JVM Configuration">JVM Configuration</a></li></ul></li><li><a href=#elasticsearch-configuration aria-label="Elasticsearch Configuration">Elasticsearch Configuration</a><ul><li><a href=#configure-security aria-label="Configure Security">Configure Security</a><ul><li><a href=#configure-transport-layer-ssl-for-node-communication aria-label="Configure transport layer SSL for node communication">Configure transport layer SSL for node communication</a></li><li><a href=#generate-passwords aria-label="Generate Passwords">Generate Passwords</a></li><li><a href=#configure-https-for-rest-api aria-label="Configure HTTPS for REST API">Configure HTTPS for REST API</a></li><li><a href=#https-configurations-for-http-clients aria-label="HTTPS configurations for HTTP clients">HTTPS configurations for HTTP clients</a><ul><li><a href=#for-kibana aria-label="For Kibana">For Kibana</a></li><li><a href=#for-beats aria-label="For Beats">For Beats</a></li></ul></li></ul></li></ul></li><li><a href=#alerting aria-label=Alerting>Alerting</a><ul><li><a href=#1-opendistro-elasticsearch-alerting aria-label="1. Opendistro Elasticsearch Alerting">1. Opendistro Elasticsearch Alerting</a></li><li><a href=#2-elastalert aria-label="2. Elastalert">2. Elastalert</a></li><li><a href=#stack-monitoring aria-label="Stack Monitoring">Stack Monitoring</a></li></ul></li><li><a href=#elatic-beats aria-label="Elatic Beats">Elatic Beats</a></li></ul></div></details></div><div class=post-content><blockquote><p>&#x1f449; This writeup is part of <a href=https://veerendra2.github.io/posts/elasticsearch-deploy/ title="previous post">&ldquo;Elasticsearch Deploy Docs&rdquo;</a> series</p></blockquote><h1 id=install>Install<a hidden class=anchor aria-hidden=true href=#install>#</a></h1><blockquote><p>&#x1f4c4; <a href=https://www.elastic.co/guide/en/elasticsearch/reference/current/elasticsearch-intro.html>Office Docs</a></p></blockquote><h2 id=hardware-requirement>Hardware Requirement<a hidden class=anchor aria-hidden=true href=#hardware-requirement>#</a></h2><blockquote><p>&#x1f4c4; <a href=https://www.elastic.co/guide/en/elasticsearch/guide/current/hardware.html>Offical Docs</a></p></blockquote><table><thead><tr><th>Resource</th><th>Minimum</th><th>Recommended</th></tr></thead><tbody><tr><td>Memory</td><td>16 GB</td><td>64 GB</td></tr><tr><td>CPU</td><td>8 Cores</td><td>16</td></tr><tr><td>Disk</td><td>Depends</td><td>Depends</td></tr></tbody></table><h2 id=jdk-installation>JDK Installation<a hidden class=anchor aria-hidden=true href=#jdk-installation>#</a></h2><ul><li>Pick JVM compatibility version with elasticsearch from <a href=https://www.elastic.co/support/matrix#matrix_jvm>here</a></li><li>Install OpenJDK from <a href=https://openjdk.java.net/install/index.html>here</a>
Download and install JDK 11 (Another guide <a href=https://jdk.java.net/java-se-ri/11>here</a>)</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ apt-get install openjdk-11-jdk -y
</span></span><span class=line><span class=cl>$ java -version
</span></span><span class=line><span class=cl>openjdk version &#34;11.0.6&#34; 2020-01-14
</span></span><span class=line><span class=cl>OpenJDK Runtime Environment (build 11.0.6+10-post-Ubuntu-1ubuntu118.04.1)
</span></span><span class=line><span class=cl>OpenJDK 64-Bit Server VM (build 11.0.6+10-post-Ubuntu-1ubuntu118.04.1, mixed mode, sharing)
</span></span></code></pre></div><h2 id=elasticsearch-installation>Elasticsearch Installation<a hidden class=anchor aria-hidden=true href=#elasticsearch-installation>#</a></h2><ul><li>Download latest elasticsearch from <a href=https://www.elastic.co/downloads/elasticsearch>here</a> (As of today the latest version is <code>7.6.2</code>)</li><li>Recommended to download/install package via <code>.dep</code> or <code>PPA</code> which postscripts creates user, groups and adds under systemd</li></ul><p><strong>Install via <code>apt-get</code> from <a href=https://www.elastic.co/guide/en/elasticsearch/reference/7.6/deb.html#deb-repo>here</a></strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -
</span></span><span class=line><span class=cl>$ sudo apt-get install apt-transport-https
</span></span><span class=line><span class=cl>$ echo &#34;deb https://artifacts.elastic.co/packages/7.x/apt stable main&#34; | sudo tee -a /etc/apt/sources.list.d/elastic-7.x.list
</span></span><span class=line><span class=cl>$ sudo apt-get update &amp;&amp; sudo apt-get install elasticsearch
</span></span></code></pre></div><p><em>*<strong>DON&rsquo;T START elasticsearch DAEMON YET!!! We need to configure</strong></em></p><h1 id=system-configuration>System Configuration<a hidden class=anchor aria-hidden=true href=#system-configuration>#</a></h1><blockquote><p>&#x1f4c4; <a href=https://www.elastic.co/guide/en/elasticsearch/reference/current/system-config.html>Official Docs</a></p></blockquote><ul><li>Create <code>data</code> directory(This <code>data</code> directory you have to specify in elasticsearch config)</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>mkdir</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>data</span><span class=o>/</span><span class=n>elasticsearch</span>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>chown</span> <span class=o>-</span><span class=n>R</span> <span class=n>elasticsearch</span><span class=p>:</span><span class=n>elasticsearch</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>data</span><span class=o>/</span><span class=n>elasticsearch</span>
</span></span></code></pre></div><ul><li>Disable swapping</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo swapoff -a
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>## *** Perminent Config ***
</span></span><span class=line><span class=cl>## Comment out any lines that contain the word &#39;swap&#39; in &#39;/etc/fstab&#39;
</span></span></code></pre></div><ul><li>Increase mmap count</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo sysctl -w vm.max_map_count=262144
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>## *** Perminent Config ***
</span></span><span class=line><span class=cl>## update the vm.max_map_count setting in /etc/sysctl.conf
</span></span></code></pre></div><ul><li>Increase file descriptors for elasticseach user</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo su
</span></span><span class=line><span class=cl># ulimit -n 65535
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>## *** Perminent Config ***
</span></span><span class=line><span class=cl>## echo &#39;elasticsearch  -  nofile  65535&#39;| sudo tee /etc/security/limits.conf
</span></span><span class=line><span class=cl>## Ubuntu ignores the limits.conf file for processes started by init.d. To enable the limits.conf file, edit /etc/pam.d/su and uncomment the following line
</span></span><span class=line><span class=cl>## # session    required   pam_limits.so
</span></span></code></pre></div><p>Systems which uses systemd limits need to be specified via systemd</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo systemctl edit elasticsearch
</span></span><span class=line><span class=cl>## Above command opens editor to override the config. Add below setting in it
</span></span><span class=line><span class=cl>[Service]
</span></span><span class=line><span class=cl>LimitMEMLOCK=infinity
</span></span></code></pre></div><ul><li>Increase number of threads count for elasticsearch user</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo su
</span></span><span class=line><span class=cl># ulimit -u 4096
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>## *** Perminent Config ***
</span></span><span class=line><span class=cl>## echo &#39;elasticsearch  -  nproc  4096&#39;| sudo tee /etc/security/limits.conf
</span></span><span class=line><span class=cl>## Ubuntu ignores the limits.conf file for processes started by init.d. To enable the limits.conf file, edit /etc/pam.d/su and uncomment the following line
</span></span><span class=line><span class=cl>## # session    required   pam_limits.so
</span></span></code></pre></div><h2 id=jvm-configuration>JVM Configuration<a hidden class=anchor aria-hidden=true href=#jvm-configuration>#</a></h2><p>Elasticsearch needs more heap memory. Change the JVM heap memory accordingly, please be noted that more heap means more garbage collection i.e more CPU utilization</p><p>Change max and min heap in <code>/etc/elasticsearch/jvm.options</code> like below (Currently we are setting 15GB for heap)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>-Xms15g
</span></span><span class=line><span class=cl>-Xmx15g
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><ul><li>Go through other JVM config or logging config if required</li></ul><p><strong>NOTE: Make sure min and max heap memories are same value to avoid bootstrap check failures</strong></p><h1 id=elasticsearch-configuration>Elasticsearch Configuration<a hidden class=anchor aria-hidden=true href=#elasticsearch-configuration>#</a></h1><blockquote><p>&#x1f4c4; <a href=https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html>Official Docs</a></p></blockquote><ul><li>If you install elasticsearch via <code>apt-get</code> or <code>.dep</code> file, the config files are located in <code>/etc/elasticsearch/</code> directory</li><li>Refer <code>elasticsearch.yml</code> configuration in <a href=https://github.com/veerendra2/elasticsearch-deploy-notes/tree/main/elasticsearch/sample_config><code>config_sample</code></a> directory specify nodes and copy configurations to nodes accordingly</li></ul><p>Once everything is ready, start <code>elasticsearch</code> daemon in all nodes</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo systemctl enable elasticsearch
</span></span><span class=line><span class=cl>$ sudo systemctl start elasticsearch
</span></span></code></pre></div><p>If everything is ok, you should get responses like below</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ curl -XGET 10.29.103.18:9200
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  &#34;name&#34; : &#34;carbon-1&#34;,
</span></span><span class=line><span class=cl>  &#34;cluster_name&#34; : &#34;carbon&#34;,
</span></span><span class=line><span class=cl>  &#34;cluster_uuid&#34; : &#34;zpoOdANFSXujgNMplMz1fQ&#34;,
</span></span><span class=line><span class=cl>  &#34;version&#34; : {
</span></span><span class=line><span class=cl>    &#34;number&#34; : &#34;7.6.2&#34;,
</span></span><span class=line><span class=cl>    &#34;build_flavor&#34; : &#34;default&#34;,
</span></span><span class=line><span class=cl>    &#34;build_type&#34; : &#34;deb&#34;,
</span></span><span class=line><span class=cl>    &#34;build_hash&#34; : &#34;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&#34;,
</span></span><span class=line><span class=cl>    &#34;build_date&#34; : &#34;2020-03-26T06:34:37.794943Z&#34;,
</span></span><span class=line><span class=cl>    &#34;build_snapshot&#34; : false,
</span></span><span class=line><span class=cl>    &#34;lucene_version&#34; : &#34;8.4.0&#34;,
</span></span><span class=line><span class=cl>    &#34;minimum_wire_compatibility_version&#34; : &#34;6.8.0&#34;,
</span></span><span class=line><span class=cl>    &#34;minimum_index_compatibility_version&#34; : &#34;6.0.0-beta1&#34;
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>  &#34;tagline&#34; : &#34;You Know, for Search&#34;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ curl -XGET 10.29.103.18:9200/_cat/nodes
</span></span><span class=line><span class=cl>10.29.103.18 7 74  5 0.07 0.91 1.95 dilm * carbon-1
</span></span><span class=line><span class=cl>10.29.103.10 2 87 25 0.08 1.08 1.68 dil  - carbon-3
</span></span><span class=line><span class=cl>10.29.103.16 5 76 25 0.18 1.13 1.75 dil  - carbon-2
</span></span></code></pre></div><h2 id=configure-security>Configure Security<a hidden class=anchor aria-hidden=true href=#configure-security>#</a></h2><ul><li>Starting from versions 6.8.0 and 7.1.0, security comes in basic. Read update blog <a href=https://www.elastic.co/blog/security-for-elasticsearch-is-now-free>here</a></li><li>Watch <a href="https://www.youtube.com/watch?v=nMh1HWWe6B4">Getting Started with Free Elasticsearch Security Features</a></li></ul><h3 id=configure-transport-layer-ssl-for-node-communication>Configure transport layer SSL for node communication<a hidden class=anchor aria-hidden=true href=#configure-transport-layer-ssl-for-node-communication>#</a></h3><ul><li>There is tool <code>elasticsearch-certutil</code> which comes with elasticsearch installation. Depends on requirement generate keys<ul><li><code>csr</code> to get certificate signing request and sign it with CA</li><li><code>cert</code> to get self signed cerificates</li><li><code>ca</code> to get certificate authority</li><li><code>http</code> for certificates fot HTTP</li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cd /usr/share/elasticsearch/bin
</span></span><span class=line><span class=cl>$ ./elasticsearch-certutil --help
</span></span><span class=line><span class=cl>Simplifies certificate creation for use with the Elastic Stack
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Commands
</span></span><span class=line><span class=cl>--------
</span></span><span class=line><span class=cl>csr - generate certificate signing requests
</span></span><span class=line><span class=cl>cert - generate X.509 certificates and keys
</span></span><span class=line><span class=cl>ca - generate a new local certificate authority
</span></span><span class=line><span class=cl>http - generate a new certificate (or certificate request) for the Elasticsearch HTTP interface
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Non-option arguments:
</span></span><span class=line><span class=cl>command
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Option             Description
</span></span><span class=line><span class=cl>------             -----------
</span></span><span class=line><span class=cl>-E &lt;KeyValuePair&gt;  Configure a setting
</span></span><span class=line><span class=cl>-h, --help         Show help
</span></span><span class=line><span class=cl>-s, --silent       Show minimal output
</span></span><span class=line><span class=cl>-v, --verbose      Show verbose output
</span></span></code></pre></div><p>Generating <a href=https://en.wikipedia.org/wiki/PKCS_12><code>.p12</code></a> and copy the file to every node</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>./elasticsearch-certutil cert
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Please enter the desired output file [elastic-certificates.p12]:/etc/elasticsearch/elastic-certificates.p12
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><ul><li>Enable SSL and specify <code>.p12</code> file location in config like below in every node in <code>elasticsearch.yml</code></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>xpack.security.enabled: true
</span></span><span class=line><span class=cl>xpack.security.transport.ssl.enabled: true
</span></span><span class=line><span class=cl>xpack.security.transport.ssl.verification_mode: certificate
</span></span><span class=line><span class=cl>xpack.security.transport.ssl.keystore.path: /etc/elasticsearch/elastic-certificates.p12
</span></span><span class=line><span class=cl>xpack.security.transport.ssl.truststore.path: /etc/elasticsearch/elastic-certificates.p12
</span></span></code></pre></div><p>Restart <code>elasticsearch</code> daemon in all nodes</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo systemctl restart elasticsearch
</span></span></code></pre></div><h3 id=generate-passwords>Generate Passwords<a hidden class=anchor aria-hidden=true href=#generate-passwords>#</a></h3><ul><li>Login into master node and run below commands</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cd /usr/share/elasticsearch
</span></span><span class=line><span class=cl>$ sudo bin/elasticsearch-setup-passwords auto
</span></span><span class=line><span class=cl>Initiating the setup of passwords for reserved users elastic,apm_system,kibana,kibana_system,logstash_system,beats_system,remote_monitoring_user.
</span></span><span class=line><span class=cl>The passwords will be randomly generated and printed to the console.
</span></span><span class=line><span class=cl>Please confirm that you would like to continue [y/N]y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Changed password for user apm_system
</span></span><span class=line><span class=cl>PASSWORD apm_system = xxxxxxxxxxxxxx
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Changed password for user kibana
</span></span><span class=line><span class=cl>PASSWORD kibana = xxxxxxxxxxxxxx
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Changed password for user logstash_system
</span></span><span class=line><span class=cl>PASSWORD logstash_system = xxxxxxxxxxxxxx
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Changed password for user beats_system
</span></span><span class=line><span class=cl>PASSWORD beats_system = xxxxxxxxxxxxxx
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Changed password for user remote_monitoring_user
</span></span><span class=line><span class=cl>PASSWORD remote_monitoring_user = xxxxxxxxxxxxxx
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Changed password for user elastic
</span></span><span class=line><span class=cl>PASSWORD elastic = xxxxxxxxxxxxxx
</span></span></code></pre></div><p>Copy those credentials and store it safe.</p><ul><li>The <code>elastic</code> user is cluster admin user</li><li>The <code>kibana</code> user is for kibana to authenticate with elasticsearch</li></ul><h3 id=configure-https-for-rest-api>Configure HTTPS for REST API<a hidden class=anchor aria-hidden=true href=#configure-https-for-rest-api>#</a></h3><ul><li>Generate certificates(Below is the process to generate certificates)</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>cd</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>elasticsearch</span>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>sudo</span> <span class=n>bin</span><span class=o>/</span><span class=n>elasticsearch</span><span class=o>-</span><span class=n>certutil</span> <span class=n>http</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## Elasticsearch HTTP Certificate Utility</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>The</span> <span class=s1>&#39;http&#39;</span> <span class=n>command</span> <span class=n>guides</span> <span class=n>you</span> <span class=n>through</span> <span class=n>the</span> <span class=n>process</span> <span class=n>of</span> <span class=n>generating</span> <span class=n>certificates</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>use</span> <span class=n>on</span> <span class=n>the</span> <span class=n>HTTP</span> <span class=p>(</span><span class=n>Rest</span><span class=p>)</span> <span class=n>interface</span> <span class=k>for</span> <span class=n>Elasticsearch</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>This</span> <span class=k>tool</span> <span class=n>will</span> <span class=n>ask</span> <span class=n>you</span> <span class=n>a</span> <span class=n>number</span> <span class=n>of</span> <span class=n>questions</span> <span class=ow>in</span> <span class=n>order</span> <span class=n>to</span> <span class=n>generate</span> <span class=n>the</span> <span class=n>right</span>
</span></span><span class=line><span class=cl><span class=n>set</span> <span class=n>of</span> <span class=n>files</span> <span class=k>for</span> <span class=n>your</span> <span class=n>needs</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## Do you wish to generate a Certificate Signing Request (CSR)?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>A</span> <span class=n>CSR</span> <span class=n>is</span> <span class=n>used</span> <span class=n>when</span> <span class=n>you</span> <span class=n>want</span> <span class=n>your</span> <span class=n>certificate</span> <span class=n>to</span> <span class=n>be</span> <span class=n>created</span> <span class=n>by</span> <span class=n>an</span> <span class=n>existing</span>
</span></span><span class=line><span class=cl><span class=n>Certificate</span> <span class=n>Authority</span> <span class=p>(</span><span class=n>CA</span><span class=p>)</span> <span class=n>that</span> <span class=n>you</span> <span class=k>do</span> <span class=ow>not</span> <span class=n>control</span> <span class=p>(</span><span class=n>that</span> <span class=n>is</span><span class=p>,</span> <span class=n>you</span> <span class=n>don</span><span class=s1>&#39;t have</span>
</span></span><span class=line><span class=cl><span class=n>access</span> <span class=n>to</span> <span class=n>the</span> <span class=n>keys</span> <span class=k>for</span> <span class=n>that</span> <span class=n>CA</span><span class=p>)</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>If</span> <span class=n>you</span> <span class=n>are</span> <span class=ow>in</span> <span class=n>a</span> <span class=n>corporate</span> <span class=n>environment</span> <span class=n>with</span> <span class=n>a</span> <span class=n>central</span> <span class=n>security</span> <span class=n>team</span><span class=p>,</span> <span class=n>then</span> <span class=n>you</span>
</span></span><span class=line><span class=cl><span class=n>may</span> <span class=n>have</span> <span class=n>an</span> <span class=n>existing</span> <span class=n>Corporate</span> <span class=n>CA</span> <span class=n>that</span> <span class=n>can</span> <span class=n>generate</span> <span class=n>your</span> <span class=n>certificate</span> <span class=k>for</span> <span class=n>you</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>Infrastructure</span> <span class=n>within</span> <span class=n>your</span> <span class=n>organisation</span> <span class=n>may</span> <span class=n>already</span> <span class=n>be</span> <span class=n>configured</span> <span class=n>to</span> <span class=n>trust</span> <span class=n>this</span>
</span></span><span class=line><span class=cl><span class=n>CA</span><span class=p>,</span> <span class=n>so</span> <span class=n>it</span> <span class=n>may</span> <span class=n>be</span> <span class=n>easier</span> <span class=k>for</span> <span class=n>clients</span> <span class=n>to</span> <span class=n>connect</span> <span class=n>to</span> <span class=n>Elasticsearch</span> <span class=k>if</span> <span class=n>you</span> <span class=n>use</span> <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=n>CSR</span> <span class=ow>and</span> <span class=n>send</span> <span class=n>that</span> <span class=n>request</span> <span class=n>to</span> <span class=n>the</span> <span class=n>team</span> <span class=n>that</span> <span class=n>controls</span> <span class=n>your</span> <span class=n>CA</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>If</span> <span class=n>you</span> <span class=n>choose</span> <span class=ow>not</span> <span class=n>to</span> <span class=n>generate</span> <span class=n>a</span> <span class=n>CSR</span><span class=p>,</span> <span class=n>this</span> <span class=k>tool</span> <span class=n>will</span> <span class=n>generate</span> <span class=n>a</span> <span class=n>new</span> <span class=n>certificate</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>you</span><span class=o>.</span> <span class=n>That</span> <span class=n>certificate</span> <span class=n>will</span> <span class=n>be</span> <span class=n>signed</span> <span class=n>by</span> <span class=n>a</span> <span class=n>CA</span> <span class=n>under</span> <span class=n>your</span> <span class=n>control</span><span class=o>.</span> <span class=n>This</span> <span class=n>is</span> <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=n>quick</span> <span class=ow>and</span> <span class=n>easy</span> <span class=n>way</span> <span class=n>to</span> <span class=n>secure</span> <span class=n>your</span> <span class=n>cluster</span> <span class=n>with</span> <span class=n>TLS</span><span class=p>,</span> <span class=n>but</span> <span class=n>you</span> <span class=n>will</span> <span class=n>need</span> <span class=n>to</span>
</span></span><span class=line><span class=cl><span class=n>configure</span> <span class=n>all</span> <span class=n>your</span> <span class=n>clients</span> <span class=n>to</span> <span class=n>trust</span> <span class=n>that</span> <span class=n>custom</span> <span class=n>CA</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>Generate</span> <span class=n>a</span> <span class=n>CSR</span><span class=err>?</span> <span class=p>[</span><span class=n>y</span><span class=o>/</span><span class=n>N</span><span class=p>]</span><span class=n>n</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## Do you have an existing Certificate Authority (CA) key-pair that you wish to use to sign your certificate?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>If</span> <span class=n>you</span> <span class=n>have</span> <span class=n>an</span> <span class=n>existing</span> <span class=n>CA</span> <span class=n>certificate</span> <span class=ow>and</span> <span class=n>key</span><span class=p>,</span> <span class=n>then</span> <span class=n>you</span> <span class=n>can</span> <span class=n>use</span> <span class=n>that</span> <span class=n>CA</span> <span class=n>to</span>
</span></span><span class=line><span class=cl><span class=nb>sign</span> <span class=n>your</span> <span class=n>new</span> <span class=n>http</span> <span class=n>certificate</span><span class=o>.</span> <span class=n>This</span> <span class=n>allows</span> <span class=n>you</span> <span class=n>to</span> <span class=n>use</span> <span class=n>the</span> <span class=n>same</span> <span class=n>CA</span> <span class=n>across</span>
</span></span><span class=line><span class=cl><span class=n>multiple</span> <span class=n>Elasticsearch</span> <span class=n>clusters</span> <span class=n>which</span> <span class=n>can</span> <span class=n>make</span> <span class=n>it</span> <span class=n>easier</span> <span class=n>to</span> <span class=n>configure</span> <span class=n>clients</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=ow>and</span> <span class=n>may</span> <span class=n>be</span> <span class=n>easier</span> <span class=k>for</span> <span class=n>you</span> <span class=n>to</span> <span class=n>manage</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>If</span> <span class=n>you</span> <span class=k>do</span> <span class=ow>not</span> <span class=n>have</span> <span class=n>an</span> <span class=n>existing</span> <span class=n>CA</span><span class=p>,</span> <span class=n>one</span> <span class=n>will</span> <span class=n>be</span> <span class=n>generated</span> <span class=k>for</span> <span class=n>you</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Use</span> <span class=n>an</span> <span class=n>existing</span> <span class=n>CA</span><span class=err>?</span> <span class=p>[</span><span class=n>y</span><span class=o>/</span><span class=n>N</span><span class=p>]</span><span class=n>n</span>
</span></span><span class=line><span class=cl><span class=n>A</span> <span class=n>new</span> <span class=n>Certificate</span> <span class=n>Authority</span> <span class=n>will</span> <span class=n>be</span> <span class=n>generated</span> <span class=k>for</span> <span class=n>you</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## CA Generation Options</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>The</span> <span class=n>generated</span> <span class=n>certificate</span> <span class=n>authority</span> <span class=n>will</span> <span class=n>have</span> <span class=n>the</span> <span class=n>following</span> <span class=n>configuration</span> <span class=n>values</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>These</span> <span class=n>values</span> <span class=n>have</span> <span class=n>been</span> <span class=n>selected</span> <span class=n>based</span> <span class=n>on</span> <span class=n>secure</span> <span class=n>defaults</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>You</span> <span class=n>should</span> <span class=ow>not</span> <span class=n>need</span> <span class=n>to</span> <span class=n>change</span> <span class=n>these</span> <span class=n>values</span> <span class=n>unless</span> <span class=n>you</span> <span class=n>have</span> <span class=n>specific</span> <span class=n>requirements</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Subject</span> <span class=n>DN</span><span class=p>:</span> <span class=n>CN</span><span class=o>=</span><span class=n>Elasticsearch</span> <span class=n>HTTP</span> <span class=n>CA</span>
</span></span><span class=line><span class=cl><span class=n>Validity</span><span class=p>:</span> <span class=mi>5</span><span class=n>y</span>
</span></span><span class=line><span class=cl><span class=n>Key</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>2048</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Do</span> <span class=n>you</span> <span class=n>wish</span> <span class=n>to</span> <span class=n>change</span> <span class=n>any</span> <span class=n>of</span> <span class=n>these</span> <span class=n>options</span><span class=err>?</span> <span class=p>[</span><span class=n>y</span><span class=o>/</span><span class=n>N</span><span class=p>]</span><span class=n>n</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## CA password</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>We</span> <span class=n>recommend</span> <span class=n>that</span> <span class=n>you</span> <span class=n>protect</span> <span class=n>your</span> <span class=n>CA</span> <span class=n>private</span> <span class=n>key</span> <span class=n>with</span> <span class=n>a</span> <span class=n>strong</span> <span class=n>password</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>If</span> <span class=n>your</span> <span class=n>key</span> <span class=n>does</span> <span class=ow>not</span> <span class=n>have</span> <span class=n>a</span> <span class=n>password</span> <span class=p>(</span><span class=ow>or</span> <span class=n>the</span> <span class=n>password</span> <span class=n>can</span> <span class=n>be</span> <span class=n>easily</span> <span class=n>guessed</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>then</span> <span class=n>anyone</span> <span class=n>who</span> <span class=n>gets</span> <span class=n>a</span> <span class=n>copy</span> <span class=n>of</span> <span class=n>the</span> <span class=n>key</span> <span class=n>file</span> <span class=n>will</span> <span class=n>be</span> <span class=n>able</span> <span class=n>to</span> <span class=n>generate</span> <span class=n>new</span> <span class=n>certificates</span>
</span></span><span class=line><span class=cl><span class=ow>and</span> <span class=n>impersonate</span> <span class=n>your</span> <span class=n>Elasticsearch</span> <span class=n>cluster</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>IT</span> <span class=n>IS</span> <span class=n>IMPORTANT</span> <span class=n>THAT</span> <span class=n>YOU</span> <span class=n>REMEMBER</span> <span class=n>THIS</span> <span class=n>PASSWORD</span> <span class=n>AND</span> <span class=n>KEEP</span> <span class=n>IT</span> <span class=n>SECURE</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>CA</span> <span class=n>password</span><span class=p>:</span>  <span class=p>[</span><span class=o>&lt;</span><span class=n>ENTER</span><span class=o>&gt;</span> <span class=k>for</span> <span class=n>none</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## How long should your certificates be valid?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Every</span> <span class=n>certificate</span> <span class=n>has</span> <span class=n>an</span> <span class=n>expiry</span> <span class=n>date</span><span class=o>.</span> <span class=n>When</span> <span class=n>the</span> <span class=n>expiry</span> <span class=n>date</span> <span class=n>is</span> <span class=n>reached</span> <span class=n>clients</span>
</span></span><span class=line><span class=cl><span class=n>will</span> <span class=n>stop</span> <span class=n>trusting</span> <span class=n>your</span> <span class=n>certificate</span> <span class=ow>and</span> <span class=n>TLS</span> <span class=n>connections</span> <span class=n>will</span> <span class=n>fail</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Best</span> <span class=n>practice</span> <span class=n>suggests</span> <span class=n>that</span> <span class=n>you</span> <span class=n>should</span> <span class=n>either</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=n>set</span> <span class=n>this</span> <span class=n>to</span> <span class=n>a</span> <span class=n>short</span> <span class=n>duration</span> <span class=p>(</span><span class=mi>90</span> <span class=o>-</span> <span class=mi>120</span> <span class=n>days</span><span class=p>)</span> <span class=ow>and</span> <span class=n>have</span> <span class=n>automatic</span> <span class=n>processes</span>
</span></span><span class=line><span class=cl><span class=n>to</span> <span class=n>generate</span> <span class=n>a</span> <span class=n>new</span> <span class=n>certificate</span> <span class=n>before</span> <span class=n>the</span> <span class=n>old</span> <span class=n>one</span> <span class=n>expires</span><span class=p>,</span> <span class=ow>or</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=n>b</span><span class=p>)</span> <span class=n>set</span> <span class=n>it</span> <span class=n>to</span> <span class=n>a</span> <span class=n>longer</span> <span class=n>duration</span> <span class=p>(</span><span class=mi>3</span> <span class=o>-</span> <span class=mi>5</span> <span class=n>years</span><span class=p>)</span> <span class=ow>and</span> <span class=n>then</span> <span class=n>perform</span> <span class=n>a</span> <span class=n>manual</span> <span class=n>update</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=n>few</span> <span class=n>months</span> <span class=n>before</span> <span class=n>it</span> <span class=n>expires</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>You</span> <span class=n>may</span> <span class=n>enter</span> <span class=n>the</span> <span class=n>validity</span> <span class=n>period</span> <span class=ow>in</span> <span class=n>years</span> <span class=p>(</span><span class=n>e</span><span class=o>.</span><span class=n>g</span><span class=o>.</span> <span class=mi>3</span><span class=n>Y</span><span class=p>),</span> <span class=n>months</span> <span class=p>(</span><span class=n>e</span><span class=o>.</span><span class=n>g</span><span class=o>.</span> <span class=mi>18</span><span class=n>M</span><span class=p>),</span> <span class=ow>or</span> <span class=n>days</span> <span class=p>(</span><span class=n>e</span><span class=o>.</span><span class=n>g</span><span class=o>.</span> <span class=mi>90</span><span class=n>D</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>For</span> <span class=n>how</span> <span class=n>long</span> <span class=n>should</span> <span class=n>your</span> <span class=n>certificate</span> <span class=n>be</span> <span class=n>valid</span><span class=err>?</span> <span class=p>[</span><span class=mi>5</span><span class=n>y</span><span class=p>]</span> <span class=mi>5</span><span class=n>Y</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## Do you wish to generate one certificate per node?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>If</span> <span class=n>you</span> <span class=n>have</span> <span class=n>multiple</span> <span class=n>nodes</span> <span class=ow>in</span> <span class=n>your</span> <span class=n>cluster</span><span class=p>,</span> <span class=n>then</span> <span class=n>you</span> <span class=n>may</span> <span class=n>choose</span> <span class=n>to</span> <span class=n>generate</span> <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=n>separate</span> <span class=n>certificate</span> <span class=k>for</span> <span class=n>each</span> <span class=n>of</span> <span class=n>these</span> <span class=n>nodes</span><span class=o>.</span> <span class=n>Each</span> <span class=n>certificate</span> <span class=n>will</span> <span class=n>have</span> <span class=n>its</span>
</span></span><span class=line><span class=cl><span class=n>own</span> <span class=n>private</span> <span class=n>key</span><span class=p>,</span> <span class=ow>and</span> <span class=n>will</span> <span class=n>be</span> <span class=n>issued</span> <span class=k>for</span> <span class=n>a</span> <span class=n>specific</span> <span class=n>hostname</span> <span class=ow>or</span> <span class=ne>IP</span> <span class=n>address</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Alternatively</span><span class=p>,</span> <span class=n>you</span> <span class=n>may</span> <span class=n>wish</span> <span class=n>to</span> <span class=n>generate</span> <span class=n>a</span> <span class=n>single</span> <span class=n>certificate</span> <span class=n>that</span> <span class=n>is</span> <span class=n>valid</span>
</span></span><span class=line><span class=cl><span class=n>You</span> <span class=n>entered</span> <span class=n>the</span> <span class=n>following</span> <span class=n>hostnames</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>-</span> <span class=n>elk</span><span class=o>-</span><span class=n>staging</span><span class=o>.</span><span class=n>mydomain</span><span class=o>.</span><span class=n>com</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Is</span> <span class=n>this</span> <span class=n>correct</span> <span class=p>[</span><span class=n>Y</span><span class=o>/</span><span class=n>n</span><span class=p>]</span><span class=n>y</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## Which IP addresses will be used to connect to your nodes?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>If</span> <span class=n>your</span> <span class=n>clients</span> <span class=n>will</span> <span class=n>ever</span> <span class=n>connect</span> <span class=n>to</span> <span class=n>your</span> <span class=n>nodes</span> <span class=n>by</span> <span class=n>numeric</span> <span class=ne>IP</span> <span class=n>address</span><span class=p>,</span> <span class=n>then</span> <span class=n>you</span>
</span></span><span class=line><span class=cl><span class=n>can</span> <span class=n>list</span> <span class=n>these</span> <span class=n>as</span> <span class=n>valid</span> <span class=ne>IP</span> <span class=s2>&#34;Subject Alternative Name&#34;</span> <span class=p>(</span><span class=n>SAN</span><span class=p>)</span> <span class=n>fields</span> <span class=ow>in</span> <span class=n>your</span>
</span></span><span class=line><span class=cl><span class=n>certificate</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>If</span> <span class=n>you</span> <span class=k>do</span> <span class=ow>not</span> <span class=n>have</span> <span class=n>fixed</span> <span class=ne>IP</span> <span class=n>addresses</span><span class=p>,</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>wish</span> <span class=n>to</span> <span class=n>support</span> <span class=n>direct</span> <span class=ne>IP</span> <span class=n>access</span>
</span></span><span class=line><span class=cl><span class=n>to</span> <span class=n>your</span> <span class=n>cluster</span> <span class=n>then</span> <span class=n>you</span> <span class=n>can</span> <span class=n>just</span> <span class=n>press</span> <span class=o>&lt;</span><span class=n>ENTER</span><span class=o>&gt;</span> <span class=n>to</span> <span class=n>skip</span> <span class=n>this</span> <span class=n>step</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>across</span> <span class=n>all</span> <span class=n>the</span> <span class=n>hostnames</span> <span class=ow>or</span> <span class=n>addresses</span> <span class=ow>in</span> <span class=n>your</span> <span class=n>cluster</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>If</span> <span class=n>all</span> <span class=n>of</span> <span class=n>your</span> <span class=n>nodes</span> <span class=n>will</span> <span class=n>be</span> <span class=n>accessed</span> <span class=n>through</span> <span class=n>a</span> <span class=n>single</span> <span class=n>domain</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=n>e</span><span class=o>.</span><span class=n>g</span><span class=o>.</span> <span class=n>node01</span><span class=o>.</span><span class=n>es</span><span class=o>.</span><span class=n>example</span><span class=o>.</span><span class=n>com</span><span class=p>,</span> <span class=n>node02</span><span class=o>.</span><span class=n>es</span><span class=o>.</span><span class=n>example</span><span class=o>.</span><span class=n>com</span><span class=p>,</span> <span class=n>etc</span><span class=p>)</span> <span class=n>then</span> <span class=n>you</span> <span class=n>may</span> <span class=n>find</span> <span class=n>it</span>
</span></span><span class=line><span class=cl><span class=n>simpler</span> <span class=n>to</span> <span class=n>generate</span> <span class=n>one</span> <span class=n>certificate</span> <span class=n>with</span> <span class=n>a</span> <span class=n>wildcard</span> <span class=n>hostname</span> <span class=p>(</span><span class=o>*.</span><span class=n>es</span><span class=o>.</span><span class=n>example</span><span class=o>.</span><span class=n>com</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=ow>and</span> <span class=n>use</span> <span class=n>that</span> <span class=n>across</span> <span class=n>all</span> <span class=n>of</span> <span class=n>your</span> <span class=n>nodes</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>However</span><span class=p>,</span> <span class=k>if</span> <span class=n>you</span> <span class=k>do</span> <span class=ow>not</span> <span class=n>have</span> <span class=n>a</span> <span class=n>common</span> <span class=n>domain</span> <span class=n>name</span><span class=p>,</span> <span class=ow>and</span> <span class=n>you</span> <span class=n>expect</span> <span class=n>to</span> <span class=n>add</span>
</span></span><span class=line><span class=cl><span class=n>additional</span> <span class=n>nodes</span> <span class=n>to</span> <span class=n>your</span> <span class=n>cluster</span> <span class=ow>in</span> <span class=n>the</span> <span class=n>future</span><span class=p>,</span> <span class=n>then</span> <span class=n>you</span> <span class=n>should</span> <span class=n>generate</span> <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=n>certificate</span> <span class=n>per</span> <span class=n>node</span> <span class=n>so</span> <span class=n>that</span> <span class=n>you</span> <span class=n>can</span> <span class=n>more</span> <span class=n>easily</span> <span class=n>generate</span> <span class=n>new</span> <span class=n>certificates</span> <span class=n>when</span>
</span></span><span class=line><span class=cl><span class=n>you</span> <span class=n>provision</span> <span class=n>new</span> <span class=n>nodes</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Generate</span> <span class=n>a</span> <span class=n>certificate</span> <span class=n>per</span> <span class=n>node</span><span class=err>?</span> <span class=p>[</span><span class=n>y</span><span class=o>/</span><span class=n>N</span><span class=p>]</span><span class=n>n</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## Which hostnames will be used to connect to your nodes?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>These</span> <span class=n>hostnames</span> <span class=n>will</span> <span class=n>be</span> <span class=n>added</span> <span class=n>as</span> <span class=s2>&#34;DNS&#34;</span> <span class=n>names</span> <span class=ow>in</span> <span class=n>the</span> <span class=s2>&#34;Subject Alternative Name&#34;</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=n>SAN</span><span class=p>)</span> <span class=n>field</span> <span class=ow>in</span> <span class=n>your</span> <span class=n>certificate</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>You</span> <span class=n>should</span> <span class=n>list</span> <span class=n>every</span> <span class=n>hostname</span> <span class=ow>and</span> <span class=n>variant</span> <span class=n>that</span> <span class=n>people</span> <span class=n>will</span> <span class=n>use</span> <span class=n>to</span> <span class=n>connect</span> <span class=n>to</span>
</span></span><span class=line><span class=cl><span class=n>your</span> <span class=n>cluster</span> <span class=n>over</span> <span class=n>http</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>Do</span> <span class=ow>not</span> <span class=n>list</span> <span class=ne>IP</span> <span class=n>addresses</span> <span class=n>here</span><span class=p>,</span> <span class=n>you</span> <span class=n>will</span> <span class=n>be</span> <span class=n>asked</span> <span class=n>to</span> <span class=n>enter</span> <span class=n>them</span> <span class=n>later</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>If</span> <span class=n>you</span> <span class=n>wish</span> <span class=n>to</span> <span class=n>use</span> <span class=n>a</span> <span class=n>wildcard</span> <span class=n>certificate</span> <span class=p>(</span><span class=k>for</span> <span class=n>example</span> <span class=o>*.</span><span class=n>es</span><span class=o>.</span><span class=n>example</span><span class=o>.</span><span class=n>com</span><span class=p>)</span> <span class=n>you</span>
</span></span><span class=line><span class=cl><span class=n>can</span> <span class=n>enter</span> <span class=n>that</span> <span class=n>here</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Enter</span> <span class=n>all</span> <span class=n>the</span> <span class=n>hostnames</span> <span class=n>that</span> <span class=n>you</span> <span class=n>need</span><span class=p>,</span> <span class=n>one</span> <span class=n>per</span> <span class=n>line</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>When</span> <span class=n>you</span> <span class=n>are</span> <span class=n>done</span><span class=p>,</span> <span class=n>press</span> <span class=o>&lt;</span><span class=n>ENTER</span><span class=o>&gt;</span> <span class=n>once</span> <span class=n>more</span> <span class=n>to</span> <span class=n>move</span> <span class=n>on</span> <span class=n>to</span> <span class=n>the</span> <span class=n>next</span> <span class=n>step</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>elk</span><span class=o>-</span><span class=n>staging</span><span class=o>.</span><span class=n>mydomain</span><span class=o>.</span><span class=n>com</span>
</span></span><span class=line><span class=cl><span class=n>Enter</span> <span class=n>all</span> <span class=n>the</span> <span class=ne>IP</span> <span class=n>addresses</span> <span class=n>that</span> <span class=n>you</span> <span class=n>need</span><span class=p>,</span> <span class=n>one</span> <span class=n>per</span> <span class=n>line</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>When</span> <span class=n>you</span> <span class=n>are</span> <span class=n>done</span><span class=p>,</span> <span class=n>press</span> <span class=o>&lt;</span><span class=n>ENTER</span><span class=o>&gt;</span> <span class=n>once</span> <span class=n>more</span> <span class=n>to</span> <span class=n>move</span> <span class=n>on</span> <span class=n>to</span> <span class=n>the</span> <span class=n>next</span> <span class=n>step</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>85.</span><span class=n>xx</span><span class=o>.</span><span class=n>xx</span><span class=o>.</span><span class=n>xx</span>
</span></span><span class=line><span class=cl><span class=mf>85.</span><span class=n>xx</span><span class=o>.</span><span class=n>xx</span><span class=o>.</span><span class=n>xx</span>
</span></span><span class=line><span class=cl><span class=mf>85.</span><span class=n>xx</span><span class=o>.</span><span class=n>xx</span><span class=o>.</span><span class=n>xx</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>You</span> <span class=n>entered</span> <span class=n>the</span> <span class=n>following</span> <span class=ne>IP</span> <span class=n>addresses</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>-</span> <span class=mf>85.</span><span class=n>xx</span><span class=o>.</span><span class=n>xx</span><span class=o>.</span><span class=n>xx</span>
</span></span><span class=line><span class=cl> <span class=o>-</span> <span class=mf>85.</span><span class=n>xx</span><span class=o>.</span><span class=n>xx</span><span class=o>.</span><span class=n>xx</span>
</span></span><span class=line><span class=cl> <span class=o>-</span> <span class=mf>85.</span><span class=n>xx</span><span class=o>.</span><span class=n>xx</span><span class=o>.</span><span class=n>xx</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Is</span> <span class=n>this</span> <span class=n>correct</span> <span class=p>[</span><span class=n>Y</span><span class=o>/</span><span class=n>n</span><span class=p>]</span><span class=n>y</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## Other certificate options</span>
</span></span><span class=line><span class=cl><span class=n>The</span> <span class=n>generated</span> <span class=n>certificate</span> <span class=n>will</span> <span class=n>have</span> <span class=n>the</span> <span class=n>following</span> <span class=n>additional</span> <span class=n>configuration</span>
</span></span><span class=line><span class=cl><span class=n>values</span><span class=o>.</span> <span class=n>These</span> <span class=n>values</span> <span class=n>have</span> <span class=n>been</span> <span class=n>selected</span> <span class=n>based</span> <span class=n>on</span> <span class=n>a</span> <span class=n>combination</span> <span class=n>of</span> <span class=n>the</span>
</span></span><span class=line><span class=cl><span class=n>information</span> <span class=n>you</span> <span class=n>have</span> <span class=n>provided</span> <span class=n>above</span> <span class=ow>and</span> <span class=n>secure</span> <span class=n>defaults</span><span class=o>.</span> <span class=n>You</span> <span class=n>should</span> <span class=ow>not</span> <span class=n>need</span> <span class=n>to</span>
</span></span><span class=line><span class=cl><span class=n>change</span> <span class=n>these</span> <span class=n>values</span> <span class=n>unless</span> <span class=n>you</span> <span class=n>have</span> <span class=n>specific</span> <span class=n>requirements</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Key</span> <span class=n>Name</span><span class=p>:</span> <span class=n>elk</span><span class=o>.</span><span class=n>mydomain</span><span class=o>.</span><span class=n>com</span>
</span></span><span class=line><span class=cl><span class=n>Subject</span> <span class=n>DN</span><span class=p>:</span> <span class=n>CN</span><span class=o>=</span><span class=n>elk</span><span class=p>,</span> <span class=n>DC</span><span class=o>=</span><span class=n>mydomain</span><span class=p>,</span> <span class=n>DC</span><span class=o>=</span><span class=n>org</span>
</span></span><span class=line><span class=cl><span class=n>Key</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>2048</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Do</span> <span class=n>you</span> <span class=n>wish</span> <span class=n>to</span> <span class=n>change</span> <span class=n>any</span> <span class=n>of</span> <span class=n>these</span> <span class=n>options</span><span class=err>?</span> <span class=p>[</span><span class=n>y</span><span class=o>/</span><span class=n>N</span><span class=p>]</span><span class=n>n</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## What password do you want for your private key(s)?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Your</span> <span class=n>private</span> <span class=n>key</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=n>will</span> <span class=n>be</span> <span class=n>stored</span> <span class=ow>in</span> <span class=n>a</span> <span class=n>PKCS</span><span class=c1>#12 keystore file named &#34;http.p12&#34;.</span>
</span></span><span class=line><span class=cl><span class=n>This</span> <span class=n>type</span> <span class=n>of</span> <span class=n>keystore</span> <span class=n>is</span> <span class=n>always</span> <span class=n>password</span> <span class=n>protected</span><span class=p>,</span> <span class=n>but</span> <span class=n>it</span> <span class=n>is</span> <span class=n>possible</span> <span class=n>to</span> <span class=n>use</span> <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=n>blank</span> <span class=n>password</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>If</span> <span class=n>you</span> <span class=n>wish</span> <span class=n>to</span> <span class=n>use</span> <span class=n>a</span> <span class=n>blank</span> <span class=n>password</span><span class=p>,</span> <span class=n>simply</span> <span class=n>press</span> <span class=o>&lt;</span><span class=n>enter</span><span class=o>&gt;</span> <span class=n>at</span> <span class=n>the</span> <span class=n>prompt</span> <span class=n>below</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>Provide</span> <span class=n>a</span> <span class=n>password</span> <span class=k>for</span> <span class=n>the</span> <span class=s2>&#34;http.p12&#34;</span> <span class=n>file</span><span class=p>:</span>  <span class=p>[</span><span class=o>&lt;</span><span class=n>ENTER</span><span class=o>&gt;</span> <span class=k>for</span> <span class=n>none</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## Where should we save the generated files?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>A</span> <span class=n>number</span> <span class=n>of</span> <span class=n>files</span> <span class=n>will</span> <span class=n>be</span> <span class=n>generated</span> <span class=n>including</span> <span class=n>your</span> <span class=n>private</span> <span class=n>key</span><span class=p>(</span><span class=n>s</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=n>public</span> <span class=n>certificate</span><span class=p>(</span><span class=n>s</span><span class=p>),</span> <span class=ow>and</span> <span class=n>sample</span> <span class=n>configuration</span> <span class=n>options</span> <span class=k>for</span> <span class=n>Elastic</span> <span class=n>Stack</span> <span class=n>products</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>These</span> <span class=n>files</span> <span class=n>will</span> <span class=n>be</span> <span class=n>included</span> <span class=ow>in</span> <span class=n>a</span> <span class=n>single</span> <span class=n>zip</span> <span class=n>archive</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>What</span> <span class=n>filename</span> <span class=n>should</span> <span class=n>be</span> <span class=n>used</span> <span class=k>for</span> <span class=n>the</span> <span class=n>output</span> <span class=n>zip</span> <span class=n>file</span><span class=err>?</span> <span class=p>[</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>elasticsearch</span><span class=o>/</span><span class=n>elasticsearch</span><span class=o>-</span><span class=n>ssl</span><span class=o>-</span><span class=n>http</span><span class=o>.</span><span class=n>zip</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>./</span><span class=n>elasticsearch</span><span class=o>-</span><span class=n>certutil</span> <span class=n>http</span>  <span class=mf>6.38</span><span class=n>s</span> <span class=n>user</span> <span class=mf>0.47</span><span class=n>s</span> <span class=n>system</span> <span class=mi>6</span><span class=o>%</span> <span class=n>cpu</span> <span class=mi>1</span><span class=p>:</span><span class=mf>38.49</span> <span class=n>total</span>
</span></span></code></pre></div><p>The zip file <code>/usr/share/elasticsearch/elasticsearch-ssl-http.zip</code> contains below files</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ unzip elasticsearch-ssl-http.zip
</span></span><span class=line><span class=cl>$ tree .
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>‚îú‚îÄ‚îÄ ca
</span></span><span class=line><span class=cl>‚îú‚îÄ‚îÄ README.txt
</span></span><span class=line><span class=cl>‚îî‚îÄ‚îÄ ca.p12
</span></span><span class=line><span class=cl>‚îú‚îÄ‚îÄ elasticsearch
</span></span><span class=line><span class=cl>‚îú‚îÄ‚îÄ README.txt
</span></span><span class=line><span class=cl>‚îú‚îÄ‚îÄ http.p12
</span></span><span class=line><span class=cl>‚îî‚îÄ‚îÄ sample-elasticsearch.yml
</span></span><span class=line><span class=cl>‚îî‚îÄ‚îÄ kibana
</span></span><span class=line><span class=cl>    ‚îú‚îÄ‚îÄ README.txt
</span></span><span class=line><span class=cl>    ‚îú‚îÄ‚îÄ elasticsearch-ca.pem
</span></span><span class=line><span class=cl>    ‚îî‚îÄ‚îÄ sample-kibana.yml
</span></span></code></pre></div><p>Create new directory <code>/etc/elasticsearch/http_ssl</code> and copy <code>http.p12</code> to all server</p><p>Add below config to <code>/etc/elasticsearchelasticsearch.yml</code> to enable http ssl like below</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>xpack.security.http.ssl.enabled: true
</span></span><span class=line><span class=cl>xpack.security.http.ssl.keystore.path: &#34;/etc/elasticsearch/http_ssl/http.p12&#34;
</span></span></code></pre></div><h3 id=https-configurations-for-http-clients>HTTPS configurations for HTTP clients<a hidden class=anchor aria-hidden=true href=#https-configurations-for-http-clients>#</a></h3><h4 id=for-kibana>For Kibana<a hidden class=anchor aria-hidden=true href=#for-kibana>#</a></h4><blockquote><p>&#x2757; Refer <a href=https://veerendra2.github.io/elasticsearch-deploy/kabana-install/ title="Kibana Installation">Kibana Installation</a> to know more</p></blockquote><p>Create <code>/etc/kibana/ca</code> and copy <code>elasticsearch-ca.pem</code> to kibana server</p><p>Add below config to <code>kibana.yml</code> to enable HTTPS communication between elasticsearch and kibana</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>elasticsearch.ssl.certificateAuthorities: [ &#34;/etc/kibana/ca/elasticsearch-ca.pem&#34; ]
</span></span></code></pre></div><h4 id=for-beats>For Beats<a hidden class=anchor aria-hidden=true href=#for-beats>#</a></h4><blockquote><p>Refer <a href=https://github.com/veerendra2/elasticsearch-deploy-notes/tree/main/beats>elasticsearch-deploy-notes/beats</a> for demo config</p></blockquote><ul><li>Use same <code>.pem</code> file to enable HTTPS communication between beats and elasticsearch(sample snippet below)</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>output.elasticsearch:
</span></span><span class=line><span class=cl>  hosts: [&#39;https://elk-staging.mydomain.com:9201&#39;]
</span></span><span class=line><span class=cl>  username: admin
</span></span><span class=line><span class=cl>  password: 123123123
</span></span><span class=line><span class=cl>  ssl:
</span></span><span class=line><span class=cl>    certificate_authorities: [&#34;/etc/elasticsearch-ca.pem&#34;]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>setup.dashboards:
</span></span><span class=line><span class=cl>  enabled: true
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>setup.kibana:
</span></span><span class=line><span class=cl>  host: &#34;https://elk-staging.mydomain.com:5691&#34;
</span></span><span class=line><span class=cl>  ssl:
</span></span><span class=line><span class=cl>    certificate_authorities: [&#34;/etc/letsencryptauthorityx3.pem&#34;]
</span></span></code></pre></div><h1 id=alerting>Alerting<a hidden class=anchor aria-hidden=true href=#alerting>#</a></h1><p>The official Elasticsearch &ldquo;Basic&rdquo; version doesn&rsquo;t include alerting. Below are the 2 opensource plugin available for elasticsearch</p><h2 id=1-opendistro-elasticsearch-alerting>1. Opendistro Elasticsearch Alerting<a hidden class=anchor aria-hidden=true href=#1-opendistro-elasticsearch-alerting>#</a></h2><blockquote><p>&#9888;&#xfe0f; Opendistro Alerting IS NOT compatible with X-Pack Security, for more information refer this <a href=https://github.com/opendistro-for-elasticsearch/alerting/issues/3>issue</a>. If the x-pack is already enabled, DO NOT install this plugin, won&rsquo;t work!. In order to install this plugin, disable x-pack security and install opendistro security</p></blockquote><p>Pick Opendistro alerting standalone plugin version compatibility <a href=https://opendistro.github.io/for-elasticsearch-docs/docs/install/plugins/>here</a></p><ul><li>Login into master node and install necessary plugins and alerting plugin like below</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1>## Go elasticseatch bin directory</span>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>cd</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>elasticsearch</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=c1>## Install Job Scheduler plugin</span>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>sudo</span> <span class=n>bin</span><span class=o>/</span><span class=n>elasticsearch</span><span class=o>-</span><span class=n>plugin</span> <span class=n>install</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>d3g5vo6xdbdb9a</span><span class=o>.</span><span class=n>cloudfront</span><span class=o>.</span><span class=n>net</span><span class=o>/</span><span class=n>downloads</span><span class=o>/</span><span class=n>elasticsearch</span><span class=o>-</span><span class=n>plugins</span><span class=o>/</span><span class=n>opendistro</span><span class=o>-</span><span class=n>job</span><span class=o>-</span><span class=n>scheduler</span><span class=o>/</span><span class=n>opendistro</span><span class=o>-</span><span class=n>job</span><span class=o>-</span><span class=n>scheduler</span><span class=o>-</span><span class=mf>1.8</span><span class=o>.</span><span class=mf>0.0</span><span class=o>.</span><span class=n>zip</span>
</span></span><span class=line><span class=cl><span class=c1>## Install Alerting plugin</span>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>sudo</span> <span class=n>bin</span><span class=o>/</span><span class=n>elasticsearch</span><span class=o>-</span><span class=n>plugin</span> <span class=n>install</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>d3g5vo6xdbdb9a</span><span class=o>.</span><span class=n>cloudfront</span><span class=o>.</span><span class=n>net</span><span class=o>/</span><span class=n>downloads</span><span class=o>/</span><span class=n>elasticsearch</span><span class=o>-</span><span class=n>plugins</span><span class=o>/</span><span class=n>opendistro</span><span class=o>-</span><span class=n>alerting</span><span class=o>/</span><span class=n>opendistro_alerting</span><span class=o>-</span><span class=mf>1.8</span><span class=o>.</span><span class=mf>0.0</span><span class=o>.</span><span class=n>zip</span>
</span></span><span class=line><span class=cl><span class=c1>## Restart Elasticsearch</span>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>sudo</span> <span class=n>systemctl</span> <span class=n>restart</span> <span class=n>elasticsearch</span>
</span></span></code></pre></div><h2 id=2-elastalert>2. Elastalert<a hidden class=anchor aria-hidden=true href=#2-elastalert>#</a></h2><p>Refer <a href=https://veerendra2.github.io/elasticsearch-deploy/elastalert-demo/ title="elastalert docs]">elastalert docs</a> for installation instructions.</p><h2 id=stack-monitoring>Stack Monitoring<a hidden class=anchor aria-hidden=true href=#stack-monitoring>#</a></h2><ul><li>Offical <a href=https://www.elastic.co/guide/en/elasticsearch/reference/7.6/configuring-metricbeat.html>Docs</a></li><li>Kibana <a href=https://www.elastic.co/guide/en/kibana/current/monitoring-metricbeat.html>Docs</a></li></ul><p>Elasticsearch can monitor itself, enable stack monitoring using REST API like below</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>PUT _cluster/settings
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  &#34;persistent&#34;: {
</span></span><span class=line><span class=cl>    &#34;xpack.monitoring.collection.enabled&#34;: true
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>We can also monitor with <code>metricbeat</code>, this method is useful especially want to monitor multiple clusters. Please refer metricbeat <code>elasticsearch-xpack</code> module config</p><h1 id=elatic-beats>Elatic Beats<a hidden class=anchor aria-hidden=true href=#elatic-beats>#</a></h1><blockquote><p>Beats is a free and open platform for single-purpose data shippers. They send data from hundreds or thousands of machines and systems to Logstash or Elasticsearch.</p></blockquote><p>Refer <a href=https://github.com/veerendra2/elasticsearch-deploy-notes/tree/main/beats>elasticsearch-deploy-notes/beats</a> for example config</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://veerendra2.github.io/tags/elasticsearch/>Elasticsearch</a></li></ul><nav class=paginav><a class=prev href=https://veerendra2.github.io/elasticsearch-deploy/config-overview/><span class=title>¬´ Prev</span><br><span>Elasticsearch Configuration Overview</span>
</a><a class=next href=https://veerendra2.github.io/elasticsearch-deploy/upgrade/><span class=title>Next ¬ª</span><br><span>Elasticsearch Upgrade</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Elasticsearch Installation on x" href="https://x.com/intent/tweet/?text=Elasticsearch%20Installation&amp;url=https%3a%2f%2fveerendra2.github.io%2felasticsearch-deploy%2finstall%2f&amp;hashtags=elasticsearch"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Elasticsearch Installation on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fveerendra2.github.io%2felasticsearch-deploy%2finstall%2f&amp;title=Elasticsearch%20Installation&amp;summary=Elasticsearch%20Installation&amp;source=https%3a%2f%2fveerendra2.github.io%2felasticsearch-deploy%2finstall%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Elasticsearch Installation on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fveerendra2.github.io%2felasticsearch-deploy%2finstall%2f&title=Elasticsearch%20Installation"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Elasticsearch Installation on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fveerendra2.github.io%2felasticsearch-deploy%2finstall%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Elasticsearch Installation on whatsapp" href="https://api.whatsapp.com/send?text=Elasticsearch%20Installation%20-%20https%3a%2f%2fveerendra2.github.io%2felasticsearch-deploy%2finstall%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Elasticsearch Installation on telegram" href="https://telegram.me/share/url?text=Elasticsearch%20Installation&amp;url=https%3a%2f%2fveerendra2.github.io%2felasticsearch-deploy%2finstall%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Elasticsearch Installation on ycombinator" href="https://news.ycombinator.com/submitlink?t=Elasticsearch%20Installation&u=https%3a%2f%2fveerendra2.github.io%2felasticsearch-deploy%2finstall%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://veerendra2.github.io/>Veerendra's Blog</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>